<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>{%(1)Group Soft Premium Payment}</title>
<link rel="stylesheet" type="text/css" href="{STYLESHEET_PATH}">
</head>
<body ONLOAD="initialise()">
  <form action="%SERVLET_PATH%" method="post">
    {ERRORS}
    <table>
      <tr>
        <td class="title" colspan="2">{HELP_LINK}{%(1)Group Soft Premium Payment}
          <a href="%BACK_LINK%">
            <span class="return_link">{%(101)Return}</span>
          </a>
        </td>
      </tr>
      <tr>
        <th width=30%>{%(3)Scheme number}</th>
        <td>{SCHEME_CODE}</td>
      </tr>
      <tr>
        <th>{%(4)Scheme Owner}</th>
        <td>{GROUP_OWNER}</td>
      </tr>
      <tr>
        <th>{%(5)Effective Date}</th>
        <td>
          <input type="text" name="EFF_DATE">
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <th>{%(11)No}</th>
        <th>{%(12)Name}</th>
        <th>{%(13)Status}</th>
        <th>{%(14)Start Date}</th>
        <!--{COV_COLUMN_LIST}-->
        <th align="right">{%(17)Total}</th>
      </tr>
      <!--{MEMBER_LIST}-->
      <tr>
        <th colspan=4>{%(21)Total}</th>
        <!--{COV_TOTAL_COLUMN_LIST}-->
        <td align="right">
          <span id="GrandTotalPayment"></span>
        </td>
      </tr>
      <tr>
        <th colspan={COL_MINUS_ONE}>{%(22)Suspense}</th>
        <td align="right">
          <span id="Suspense"></span>
        </td>
      </tr>
    </table>
    <table class="navigation">
      <tr>
        <td>
          <input type="submit" name="ProcessButton" value="{%(102)Process}">
        </td>
        <td class="return">
          <a href="%BACK_LINK%">
            {%(101)Return}
            <img src="/lf/images/back.gif">
          </a>
        </td>
      </tr>
    </table>
  </form>
  <input type="hidden" name="EmployerText" value="{%(15)Employer}">
  <input type="hidden" name="EmployeeText" value="{%(16)Employee}">
</body>
<script type="text/javascript">
var original_suspense;
var plan_count;
var member_count;
function initialise()
{
	original_suspense = parse_float("{SUSPENSE}");
	set_focus();
	plan_count = 0;
	while (document.forms[0].elements["PlanName_"+plan_count])
	  plan_count++;
	member_count = 0;
	while (document.forms[0].elements["MemberNo_"+member_count])
    member_count++;
	var element_index = 0;
	for (member_index=0; member_index<member_count; member_index++)
	{
		var member_no = document.forms[0].elements["MemberNo_"+member_index].value;
		for (i=0; i<plan_count; i++)
		{
		  var plan_name = document.forms[0].elements["PlanName_"+i].value;
		  input_box = document.forms[0].elements["PaymentAmount_"+plan_name+"_"+member_no];
		  if (input_box)
  	    input_box.onkeyup = updateTotals;
	  }	
		element_index++;
	}
	updateTotals();
}
function updateTotals()
{
  var total_amount = 0;
  for (plan_index=0; plan_index<plan_count; plan_index++)
  {  
    var col_total = 0;
    var plan_name = document.forms[0].elements["PlanName_"+plan_index].value;
    for (member_index=0; member_index<member_count; member_index++)
	  {
		  var member_no = document.forms[0].elements["MemberNo_"+member_index].value;
		  var input_box = document.forms[0].elements["PaymentAmount_"+plan_name+"_"+member_no];
		  if (input_box)
		  {
		    amount = parse_float(input_box.value);
        if (amount=="")
		      amount = 0;
		    col_total += amount;
		  }
		}      
		total_amount += col_total;
		document.getElementById("TotalPayment_"+plan_name).innerHTML = format_float(col_total,2);
		member_index++;
	}
	document.getElementById("GrandTotalPayment").innerHTML = format_float(total_amount,2);
	document.getElementById("Suspense").innerHTML = format_float(original_suspense-total_amount,2);
  for (member_index=0; member_index<member_count; member_index++)
  {
    var member_total = 0;
	  var member_no = document.forms[0].elements["MemberNo_"+member_index].value;
	  for (plan_index=0; plan_index<plan_count; plan_index++)
	  {
      var plan_name = document.forms[0].elements["PlanName_"+plan_index].value;
      var input_box = document.forms[0].elements["PaymentAmount_"+plan_name+"_"+member_no];
	    if (input_box)
      {
	      amount = parse_float(input_box.value);
        if (amount=="")
	        amount = 0;
	    }    
	    member_total += amount;
	  }
    document.getElementById("TotalPaymentAmount_"+member_no).innerHTML = format_float(member_total,2);
  }  
}
</script>
</html>
